version: '3.9'
services:
  dns-checker-cache:
    image: redis:latest
    networks:
      - toncenter-network
    deploy:
      mode: replicated
      replicas: 1
  dns-checker:
    image: localhost:5000/dns-check-backend:latest
    build:
      context: .
      dockerfile: Dockerfile
    # command: -c "uvicorn dnschecker.mock:app --host 0.0.0.0 --port 8081"
    command: -c "uvicorn dnschecker.main:app --host 0.0.0.0 --port 8081"
    networks:
      - toncenter-network
    secrets:
      - global-config
    deploy:
      mode: replicated
      replicas: 1
networks:
  toncenter-network:
    external: true
secrets:
  global-config:
    file: private/global-config.json